b' <!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1">  <meta name="description" content="www.paste.org - allows users to paste snippets of text, usually samples of source code, for public viewing."> <meta name="author" content="An Australian"> <link rel="icon" href="/favicon.ico"> <title>Paste code - paste.org</title>  <link href="/assets/themes/bleh/css/github-highlight.css" rel="stylesheet"> <script src="/assets/themes/bleh/js/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();</script> </head> <body> <p><pre><code class="vbnet">\'//Main app entry point\nPublic Function startProcess() As Boolean\n    \'//Consolidate all imported data by Boxnr and load date and create it into table ExportLoaddate\n    DoCmd.OpenQuery (&quot;UploadSQL_1_ConsolidateByBox&quot;)\n    \'//Delete everything from import table to enable new feed\n    DoCmd.OpenQuery (&quot;UploadSQL_2_DeleteImport&quot;)\n    \'//Run method\n    Feeddatabase\n    \'//Return value\n    startProcess = True\nEnd Function\n\n\nPublic Sub Feeddatabase()\n    \'//Based on ADODB ref\n    \'//Create connection (for the SQL server)\n    Dim myConn As New ADODB.Connection\n    \'//Create recordset (our DB table)\n    Dim myRS As New ADODB.Recordset\n    \'//Create SQL placeholder\n    Dim SQLCOMM As String\n    \'//\n    \'//Open connection to the server\n    myConn.open _\n        &quot;Provider=SQLOLEDB;&quot; &amp; _\n        &quot;Data Source=BUPC1537\\SQLSERVER;&quot; &amp; _\n        &quot;Initial Catalog=TID;&quot; &amp; _\n        &quot;User ID=HouthalenUser;&quot; &amp; _\n        &quot;Password=:-);&quot;\n    \'//First delete everything in the Feed table\n    SQLCOMM = _\n        &quot;DELETE FROM [TID].[Feed].[UPLOADLOADINGEND];&quot;\n    myConn.Execute (SQLCOMM)\n    \'//Next, we load table ExportLoaddate into our Recordset (using the local connection (local db),\n    \'//                                                       open as snapshot (to be able to read recordcount),\n    \'//                                                       and place the recordset under readonly rights)\n    myRS.open &quot;SELECT [load date], [Boxnr] FROM [ExportLoaddate]&quot;, CurrentProject.Connection, adOpenStatic, adLockReadOnly\n    \'//We check if the recordset is populated\n    If (myRS.RecordCount &gt; 0) Then\n        myRS.MoveFirst\n        \'//Run through each record from the table\n        Do While (Not myRS.EOF)\n            \'//Create an insert command based on the current record and feed it to the SQL database\n            SQLCOMM = _\n                &quot;INSERT INTO [TID].[Feed].[UPLOADLOADINGEND] &quot; &amp; _\n                &quot;VALUES(\'&quot; &amp; myRS.Fields(&quot;Boxnr&quot;) &amp; &quot;\', CONVERT(date, \'&quot; &amp; Format(myRS.Fields(&quot;load date&quot;), &quot;YYYYMMDD&quot;) &amp; &quot;\'));&quot;\n            myConn.Execute (SQLCOMM)\n            myRS.MoveNext\n        Loop\n        \'//Execute written procedure in SQL to match all Boxnrs with their newly acquired date\n        SQLCOMM = &quot;EXEC [TIDCoding].[UpdateLoadDate];&quot;\n        myConn.Execute (SQLCOMM)\n    Else\n        MsgBox Prompt:=&quot;No records found to upload... The table does not seem to be populated.&quot; &amp; vbCrLf &amp; _\n                       &quot;Please notify your Database administrator&quot;, Buttons:=vbInformation, Title:=&quot;No records&quot;\n    End If\n    \'//Close all streams\n    myRS.Close\n    myConn.Close\n    DoCmd.Quit\nEnd Sub</code></pre></p> <p align="right"><span style="font-size: 60%">Add a code snippet to your website: <a href="https://www.paste.org" target="_blank">www.paste.org</a></span></p> </body> </html>'